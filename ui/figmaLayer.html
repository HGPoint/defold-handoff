<button id="createGUINode">Create Advanced Defold Component</button>
<button id="copyComponentToDefold">Copy Component to Defold</button>
<button id="exportComponentToDefold">Export Component to Defold</button>

<script>
  const createGUINode = document.getElementById('createGUINode');
  const copyComponentToDefold = document.getElementById('copyComponentToDefold');
  const exportComponentToDefold = document.getElementById('exportComponentToDefold');

  function isPluginMessage(event) {
    return event.data?.pluginMessage;
  }

  function exportComponent({ component }) {

  }

  function copyComponent({ component }) {

  }

  function postMessageToPlugin(type) {
    parent.postMessage({ pluginMessage: { type } }, "*");
  }

  function onCreateAdvancedDefoldComponent() {
    postMessageToPlugin("createGUINode");
  }

  function onCopyComponentToDefold() {
    postMessageToPlugin("copyGUINodes");
  }

  function onComponentsCopiedToDefold(data) {
    copyComponent(data);
  }

  function onExportComponentToDefold() {
    postMessageToPlugin("exportGUINodes");
  }

  function onComponentsExportedToDefold(data) {
    exportComponent(data);
  }

  function onPluginMessage() {
    if (isPluginMessage(event)) {
      const { pluginMessage } = event.data;
      const { type, data } = pluginMessage;
      if (type === "guiNodesExported") {
        onComponentsExportedToDefold(data);
      } else if (type === "guiNodesCopied") {
        onComponentsCopiedToDefold(data);
      }
    }
  }

  function initializeUI() {
    createGUINode.addEventListener("click", onCreateAdvancedDefoldComponent);
    copyComponentToDefold.addEventListener("click", onCopyComponentToDefold);
    exportComponentToDefold.addEventListener("click", onExportComponentToDefold);
    window.addEventListener("message", onPluginMessage);
  }

  initializeUI();
</script>
